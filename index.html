<!-- detection/templates/detection/map.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>YOLOv5与高德地图集成</title>
    <!-- 引入高德地图API -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=你的高德API Key"></script>
</head>
<body>
    <div id="container" style="width: 600px; height: 400px;"></div>
    <script type="text/javascript">
        var map = new AMap.Map('container', {
            resizeEnable: true,
            center: [116.397428, 39.90923], // 初始中心点
            zoom: 13
        });

        // 获取用户当前位置并在地图上显示
        function getUserLocation() {
            if (navigator.geolocation) {
                var options = {
                    enableHighAccuracy: true, // 启用高精度定位
                    timeout: 5000, // 超过5000毫秒（5秒）则放弃定位请求
                    maximumAge: 0 // 定位结果的最大年龄，0表示始终获取最新的定位结果
                };
                navigator.geolocation.getCurrentPosition(function(position) {
                    var latitude = position.coords.latitude;
                    var longitude = position.coords.longitude;
                    // 更新地图中心点到用户位置
                    map.setCenter([longitude, latitude]);
                    // 在用户位置添加标记
                    var marker = new AMap.Marker({
                        position: new AMap.LngLat(longitude, latitude),
                        map: map
                    });
                    // 设置标记的标签内容
                    marker.setLabel({
                        content: "您的位置",
                        offset: new AMap.Pixel(20, -10)
                    });
                }, function(error) {
                    console.error("Geolocation error: ", error);
                }, options);
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }

        // 当地图加载完成后获取用户位置
        AMap.event.addListenerOnce(map, 'complete', getUserLocation);
    </script>
</body>
</html>
